<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="gwopa">
<body>

<metal:content-core fill-slot="main"
    tal:define="portal_state context/@@plone_portal_state;
                portal_url portal_state/portal_url;">

  <metal:block define-macro="content-core" tal:define="currentYear view/getYear">
    <div class="block-nav">
      <ul class="pagination pagination-lg" tal:define="items view/getItems">
        <tal:block tal:repeat="item items">
          <li tal:attributes="class item/classe; alt item/alt; title item/alt">
            <a href="#" tal:attributes="href item/url"><tal:omit-tag tal:content="item/title"></tal:omit-tag>&nbsp;<tal:omit-tag tal:content="item/year"></tal:omit-tag></a>
          </li>
        </tal:block>
      </ul>
    </div>
    <h1 class="documentFirstHeading">
      <tal:omit-tag i18n:translate=""> Planning </tal:omit-tag> -
      <span><tal:omit-tag tal:content="view/projectTitle"></tal:omit-tag></span></h1>
    <div class="documentDescription description projectDates">
      <span class="dateNumbers">
        <tal:omit-tag i18n:translate=""> Project year </tal:omit-tag>&nbsp;<tal:omit-tag tal:content="currentYear"> 2019 </tal:omit-tag>
      </span>
      <tal:omit-tag i18n:translate=""> goes from </tal:omit-tag>&nbsp;<span tal:content="view/getFaseStart" class="dateNumbers"> 2019-02-02 </span>&nbsp;<tal:omit-tag i18n:translate=""> to </tal:omit-tag>&nbsp;<span tal:content="view/getFaseEnd" class="dateNumbers"> 2019-03-03 </span>&nbsp;<span tal:content="view/getPhases" id="totalPhases" style="display: none"></span>
    </div>
    <div id="tabsplanning" class="pat-autotoc autotabs" data-pat-autotoc="levels: legend; section: fieldset;">
      <fieldset>
        <legend i18n:translate=""> Project </legend>
        <tal:block-activities tal:define="areas view/getAreas" tal:condition="areas">
          <div class="documentDescription titleCollapse">
            <span id="collapseAllProjectTab"><tal:omit-tag i18n:translate=""> Collapse all </tal:omit-tag>&nbsp;<i class="fas fa-chevron-up"></i></span>
            <span id="expandAllProjectTab"><tal:omit-tag i18n:translate=""> Expand all </tal:omit-tag>&nbsp;<i class="fas fa-chevron-down"></i></span>
          </div>
          <tal:objects repeat="item areas">
            <div class="tabla_contenido_items" id="project" tal:define="files python:view.indicatorsInside(item);">
              <div class="tabla_cabecera">
                <div class="information" id="header">
                  <div class="contentt" id="total">
                    <div class="btn-group" role="group" aria-label="Add element">
                      <div data-toggle="dropdown"><i class="fas fa-plus-circle"></i></div>
                      <ul class="dropdown-menu" role="menu" aria-labelledby="types">
                        <li>
                          <a class="pat-plone-modal" tabindex="-1" tal:attributes="href string:${item/url}/++add++Activity">
                            <i class="fas fa-plus-circle"></i><tal:omit-tag i18n:translate=""> Add Activity </tal:omit-tag></a>
                        </li>
                      </ul>
                    </div>
                    <div class="titleRowPlanning"><a tal:attributes="href item/url" tal:content="item/title"> Area Title </a></div>
                  </div>
                  <div class="contentt" id="bl" i18n:translate="">Starting date</div>
                  <div class="contentt" id="value" i18n:translate="">Completion date</div>
                  <div class="contentt" id="target" i18n:translate="">Target value</div>
                  <div class="contentt" id="resp" i18n:translate="">Responsible</div>
                  <div class="contentt" id="actions" i18n:translate="">Action </div>
                  <i class="fas fa-chevron-up collapseItem"></i>
                  <i class="fas fa-chevron-down expandItem"></i>
                </div>
              </div>
              <div class="tabla_cuerpo" tal:repeat="item files">
                <div class="col-md-12 text-item-planning">
                      <div class="information object">
                        <div class="contentt row" id="total">
                          <div class="part0">
                            <tal:block tal:condition="python:item['portal_type'] == 'Activity'">
                              <div class="btn-group" role="group" aria-label="Add element">
                                <div data-toggle="dropdown"><i class="fas fa-plus-circle"></i></div>
                                <ul class="dropdown-menu" role="menu" aria-labelledby="types">
                                  <li>
                                    <a data-toggle="modal" class="afegirOutput" data-target="#modalOutput" tal:attributes="data-val view/getPath" style="float: left;">
                                          <i class="fas fa-plus-circle"></i><tal:omit-tag i18n:translate=""> Add Output </tal:omit-tag></a>
                                  </li>
                                </ul>
                              </div>
                            </tal:block>
                          </div>
                          <div class="part1">
                            <span tal:attributes="class string:${item/portal_type}-planning first-level" tal:content="item/portal_type" i18n:translate="">Activity/output label</span>
                          </div>
                          <div class="part2 titulocatplan" tal:attributes="id item/portal_type" tal:content="item/title"> Activity/Output Title </div>
                        </div>
                        <div class="contentt center_span" id="bl">
                          <span tal:content="item/start">2019-03-29</span>
                        </div>
                        <div class="contentt center_span" id="value">
                          <span tal:content="item/end">2019-03-30</span>
                        </div>
                        <div class="contentt center_span" id="target">
                          <span tal:condition="python:item['portal_type'] == 'Activity'" tal:content="item/target_value_planned"> Value</span>
                          <span tal:attributes="
                              data-pk currentYear;
                              data-name item/url;
                              data-url string:${context/absolute_url}/changeTarget"
                              data-type="text"
                              data-title="Change target value"
                              class="editable" tal:condition="python:item['portal_type'] == 'Output'" tal:content="item/target_value_planned"> Target Value Planned
                          </span>
                          <tal:omit-tag tal:content="item/unit"> Unit </tal:omit-tag>
                        </div>
                        <div class="contentt center_span" id="resp" tal:define="members item/responsible">
                          <ul tal:condition="members"><li tal:repeat="member members" tal:content="member"> Member Name </li></ul>
                          <tal:block tal:condition="not:members" i18n:translate=""> Not assigned </tal:block>
                        </div>
                        <div class="contentt" id="actions">
                          <a class="pat-plone-modal"
                            tal:attributes="
                              href string:${item/url}/edit;
                              title string:Edit ${item/title};
                              alt string:Edit ${item/title}"><i class="far fa-edit"></i></a>
                          <a href="#confirm-delete" data-toggle="modal"  class="btn-delete"
                            tal:attributes="
                              data-url item/url;
                              data-type item/portal_type;
                              data-id item/title;" title="Delete" alt="Delete">
                            <i class="far fa-trash-alt"></i></a>
                        </div>
                        <tal:omit-tag  tal:condition="python:item['portal_type'] == 'Activity'">
                          <i class="fas fa-chevron-up collapseItem" aria-hidden="true"></i>
                          <i class="fas fa-chevron-down expandItem" aria-hidden="true"></i>
                       </tal:omit-tag>
                      </div>
                  <tal:block tal:condition="python:item['portal_type'] == 'Activity'" tal:define="outputs python:view.indicatorsInside(item);">
                    <div tal:repeat="output outputs" class="block_sub_indicators">
                      <div class="information object">
                        <div class="contentt row" id="total">
                          <div class="part1 label-2nd">
                            <span tal:attributes="class string:${output/portal_type}-planning second-level" tal:content="output/portal_type" i18n:translate="">Type Output</span>
                          </div>
                          <div class="part2 titulocatplan" tal:attributes="id output/portal_type" tal:content="output/title"> Item Title </div>
                        </div>
                        <div class="contentt" id="bl" tal:content="output/start">2019-03-29</div>
                        <div class="contentt" id="value" tal:content="output/end">2019-03-30</div>
                        <div class="contentt" id="target">
                          <span tal:attributes="
                              data-pk currentYear;
                              data-name output/url;
                              data-url string:${context/absolute_url}/changeTarget"
                              data-type="text"
                              data-title="Change target value"
                              class="editable" tal:content="output/target_value_planned"> Target Value Planned
                          </span>
                          <tal:omit-tag tal:content="output/unit"> Unit </tal:omit-tag>
                        </div>
                        <div class="contentt" id="resp" tal:define="members output/responsible">
                          <ul tal:condition="members"><li tal:repeat="member members" tal:content="member"> Member Name </li></ul>
                          <ul tal:condition="not:members"><li i18n:translate=""> Not assigned </li></ul>
                        </div>
                        <div class="contentt" id="actions">
                          <a class="pat-plone-modal"
                            tal:attributes="
                              href string:${output/url}/edit;
                              title string:Edit ${output/title};
                              alt string:Edit ${output/title}"><i class="far fa-edit"></i></a>
                          <a href="#confirm-delete" data-toggle="modal"  class="btn-delete"
                            tal:attributes="
                              data-url output/url;
                              data-type output/portal_type;
                              data-id output/title;" title="Delete" alt="Delete">
                            <i class="far fa-trash-alt"></i></a>
                        </div>
                      </div>
                    </div>
                  </tal:block>
                </div>
              </div>
            </div>
          </tal:objects>
        </tal:block-activities>
      </fieldset>
      <fieldset>
        <legend i18n:translate=""> Outcomes </legend>
        <div class="documentDescription titleCollapse">
          <span id="collapseAllOutcomeTab"><tal:omit-tag i18n:translate=""> Collapse all </tal:omit-tag>&nbsp;<i class="fas fa-chevron-up"></i></span>
          <span id="expandAllOutcomeTab"><tal:omit-tag i18n:translate="">Expand all </tal:omit-tag>&nbsp;<i class="fas fa-chevron-down"></i></span>
        </div>
        <div id="outcomes">
          <div class="tabla_contenido_items" tal:define="outcomes view/listOutcomesKPI">
            <div class="tabla_cabecera">
              <div class="information object" id="header">
                <div class="contentt" id="total">
                  <div class="btn-group" role="group" aria-label="Add KPI">
                    <div data-toggle="dropdown"><i class="fas fa-plus-circle"></i></div>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="kpis">
                      <li>
                        <a data-toggle="modal" class="afegirKPI" data-target="#modalKPI" tal:attributes="data-val context/absolute_url_path">
                          <i class="fas fa-plus-circle"></i><tal:omit-tag i18n:translate=""> New Overall KPI </tal:omit-tag></a>
                      </li>
                      <li>
                        <a class="pat-plone-modal" tabindex="-1" href="" tal:attributes="href string:${context/absolute_url}/++add++OutcomeZONE"><span><i class="fas fa-plus-circle"></i> New KPI Zone </span></a>
                      </li>
                    </ul>
                  </div>
                  <div class="titleRowPlanning">
                    <tal:omit-tag i18n:translate=""> Utility Performance </tal:omit-tag>
                  </div>
                </div>
                <div class="contentt" id="bl" i18n:translate=""> Baseline date </div>
                <div class="contentt" id="value" i18n:translate=""> Baseline value </div>
                <div class="contentt" id="target" i18n:translate=""> Target value </div>
                <div class="contentt" id="mu" i18n:translate=""> Frequency </div>
                <div class="contentt" id="resp" i18n:translate=""> Responsible </div>
                <div class="contentt" id="actions" i18n:translate=""> Action </div>
                <i class="fas fa-chevron-up collapseOutcome" aria-hidden="true"></i>
                <i class="fas fa-chevron-down expandOutcome" aria-hidden="true"></i>
              </div>
            </div>
            <div class="tabla_cuerpo">
              <tal:objects repeat="outcome outcomes">
                <div class="col-md-12 text-item-planning">
                  <div class="information object">
                    <div class="contentt" id="total">
                      <div tal:attributes="class string:${outcome/portal_type}-planning" tal:content="outcome/portal_type" i18n:translate=""> Outcome - KPI Type</div>
                      <h4 class="titulocatplan" tal:content="outcome/title">KPI</h4>
                    </div>
                    <div class="contentt" id="bl" tal:content="outcome/base_date">2019-03-30</div>
                    <div class="contentt" id="value" tal:content="outcome/base_value">2019-06-22</div>

                    <div class="contentt" id="target">
                      <span tal:attributes="
                          data-pk currentYear;
                          data-name outcome/url;
                          data-url string:${context/absolute_url}/changeTarget"
                          data-type="text"
                          data-title="Change target value"
                          class="editable" tal:content="outcome/target_value_planned"> Target Value Planned
                      </span>
                      <tal:omit-tag tal:content="outcome/unit"> Unit </tal:omit-tag>
                    </div>
                    <div class="contentt" id="freq" tal:content="outcome/measuring_frequency"> Frequency </div>
                      <div class="contentt" id="resp" tal:define="members outcome/responsible">
                        <ul tal:condition="members"><li tal:repeat="member members" tal:content="member"> Member Name </li></ul>
                        <ul tal:condition="not:members"><li i18n:translate=""> Not assigned </li></ul>
                      </div>
                    <div class="contentt" id="actions">
                      <a class="pat-plone-modal" tal:attributes="href string:${outcome/url}/edit" title="Edit" alt="Edit">
                        <i class="far fa-edit"></i>
                      </a>
                      <a href="#confirm-delete" data-toggle="modal" class="btn-delete"
                        tal:attributes="
                              data-url outcome/url;
                              data-type outcome/portal_type;
                              data-id outcome/title;" title="Delete" alt="Delete">
                        <i class="far fa-trash-alt"></i>
                      </a>
                    </div>
                  </div>
                </div>
              </tal:objects>
            </div>
          </div>
          <div class="tabla_contenido_items" tal:define="outcomes view/listOutcomesCC" tal:condition="outcomes">
            <div class="tabla_cabecera">
              <div class="information object" id="header">
                <div class="contentt" id="total">
                  <div class="titleRowPlanning">
                    <tal:omit-tag i18n:translate=""> Utility Capacity </tal:omit-tag>
                  </div>
                </div>
              </div>
            </div>
            <div class="tabla_cuerpo">
              <div class="col-md-12 text-item-planning" tal:repeat="outcome outcomes">
                <div class="information object">
                  <div class="contentt addCapacity" id="total">
                    <div class="btn-group" role="group" aria-label="Add element">
                      <div data-toggle="dropdown">
                        <i class="fas fa-plus-circle"></i>
                      </div>
                      <ul class="dropdown-menu" role="menu" aria-labelledby="types">
                        <li>
                          <a class="pat-plone-modal" tabindex="-1" tal:attributes="href string:${outcome/url}/++add++OutcomeCC">
                              <i class="fas fa-plus-circle"></i>&nbsp;<tal:omit-tag i18n:translate="">Improve generic Capacity Change</tal:omit-tag></a>
                        </li>
                        <li>
                          <a class="pat-plone-modal" tabindex="-1" tal:attributes="href string:${outcome/url}/++add++OutcomeCCS">
                              <i class="fas fa-plus-circle"></i>&nbsp;<tal:omit-tag i18n:translate="">Improve specific Capacity Change</tal:omit-tag></a>
                        </li>
                      </ul>
                    </div>
                    <div class="CC-planning" i18n:translate="">Improve capacity in</div>
                    <h4 class="titulocatplan" id="output" tal:content="outcome/area"> Working Area 1 </h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </fieldset>
    </div>

    <div id="modalOutput" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalAddOutput" data-dismiss="modal" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <form>
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="modalAddOutput" i18n:translate=""> Add Output </h4>
            </div>
            <div class="modal-body" id="NewOutput">
              <div class="modal-url" id="OutputPath" style="display:none"></div>
              <div class="col-md-12">
                <div class="form-group">
                  <label id="label-output" i18n:translate="">Title</label>
                  <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                  <input id="out-title" type="hidden"/>
                </div>
                <div class="form-group">
                    <label for="message-text" class="control-label" i18n:translate="">Description</label>
                    <textarea class="form-control" id="out-description"></textarea>
                </div>
                <div class="form-group">
                    <label for="message-text" class="control-label" i18n:translate="">Baseline description</label>
                    <textarea class="form-control" id="out-baseline"></textarea>
                </div>
                <div class="form-group">
                    <label class="control-label" i18n:translate="">Completion date</label>
                    <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                    <input id="out-datetimepicker" class="pat-pickadate"
                    tal:attributes="data-pat-pickadate view/custom_pattern_options" />
                </div>
                <div class="form-group">
                  <div class="col-md-6" style="padding-left: 0px;">
                    <label id="label-unit" i18n:translate=""> Measuring unit </label>
                    <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                    <input id="out-unit" type="hidden"/>
                  </div>
                  <div class="col-md-6" style="padding-right: 0px;">
                    <label id="label-frequency" i18n:translate=""> Measuring frequency </label>
                    <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                    <input id="out-frequency" type="hidden"/>
                  </div>
                </div>
                <div class="form-group" id='TextBoxesGroup'>
                  <div id="TextBoxDiv1">
                    <div class="row">
                      <div class="col-md-6" style="margin-top: 0px; padding-left: 0px;">
                        <label for="message-text" class="control-label" i18n:translate=""> Target value </label>
                        <input type="text" class="form-control" id="target-value-1" i18n:attributes="placeholder value_for_date" placeholder="Indicate the target value for this date"/>
                      </div>
                      <div class="col-md-6" style="margin:0px 0px 10px 0px; padding-right: 0px;">
                        <label for="message-text" class="control-label" i18n:translate=""> Target date </label>
                        <p id="target-date-1" style="padding: 6px 12px;"></p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <button type="button" id='addTargetValueButton'>
                    <i class="fas fa-plus-circle" aria-hidden="true"></i>&nbsp;<tal:omit-tag i18n:translate="">Add target</tal:omit-tag>
                  </button>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label" i18n:translate="">Means of verification</label>
                  <textarea class="form-control" id="out-means"></textarea>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label" i18n:translate="">Risks / Assumptions</label>
                  <textarea class="form-control" id="out-risks"></textarea>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label" i18n:translate="">Responsible people</label>
                  <input type="hidden" class="pat-select2" id="out-responsible"
                              data-pat-select2="placeholder:Search users;
                                                vocabularyUrl:select2-users.json;"/>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <a type="button" class="btn button-cancel" data-dismiss="modal" i18n:translate="">Cancel</a>
              <a type="submit" class="btn button-save" id="createOutputFromModal"  data-dismiss="modal" i18n:translate="">Create</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="modalKPI" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalAddKPI" data-dismiss="modal" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <form class="form-horizontal">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="modalAddKPI" i18n:translate=""> Add KPI </h4>
            </div>
            <div class="modal-body" id="NewKPI">
              <div class="modal-url" id="KPIPath" style="display:none"></div>
              <div class="col-md-12">
                <div class="form-group">
                  <label id="label-kpi" i18n:translate="">Title</label>
                  <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                  <input id="kpi-title" type="hidden"/>
                </div>
                <div class="form-group">
                    <label for="message-text" class="control-label" i18n:translate="">Description</label>
                    <textarea class="form-control" id="kpi-description"></textarea>
                </div>
                <div class="form-group">
                      <div class="col-md-6" style="padding-left: 0px;">
                    <label for="message-text" class="control-label" i18n:translate="">Baseline value</label>
                    <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                    <input class="form-control" id="kpi-baseline" />
                  </div>
                  <div class="col-md-6">
                      <label class="control-label" i18n:translate="">Baseline date</label>
                      <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                      <input id="kpi-datetimepicker" class="pat-pickadate"
                      tal:attributes="data-pat-pickadate view/custom_pattern_options" />
                  </div>
                </div>
                <div class="form-group">
                  <div class="col-md-6" style="padding-left: 0px;">
                    <label id="label-unit" i18n:translate=""> Measuring unit </label>
                    <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                    <input id="kpi-unit" type="hidden"/>
                  </div>
                  <div class="col-md-6" style="padding-right: 0px;">
                    <label id="label-frequency" i18n:translate=""> Measuring frequency </label>
                    <span class="requiredfield" title="Required"> <i class="fas fa-circle"></i> </span>
                    <input id="kpi-frequency" type="hidden"/>
                  </div>
                </div>
                <div class="form-group" id='KPITextBoxesGroup'>
                  <div id="KPITextBoxDiv1">
                    <div class="row">
                      <div class="col-md-6" style="margin-top: 0px; padding-left:0px;">
                        <label for="message-text" class="control-label" i18n:translate=""> Target value </label>
                        <input type="text" class="form-control" id="kpi-target-value-1" i18n:attributes="placeholder value_for_date" placeholder="Indicate the target value for this date"/>
                      </div>
                      <div class="col-md-6" style="margin:0px 0px 10px 0px; padding-right:0px;">
                        <label for="message-text" class="control-label" i18n:translate=""> Target date </label>
                        <p id="kpi-target-date-1" style="padding: 6px 12px;"></p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <button type="button" id='KPIaddTargetValueButton'>
                    <i class="fas fa-plus-circle" aria-hidden="true"></i>&nbsp;<tal:omit-tag i18n:translate="">Add target</tal:omit-tag>
                  </button>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label" i18n:translate="">Means of verification</label>
                  <textarea class="form-control" id="kpi-means"></textarea>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label" i18n:translate="">Risks / Assumptions</label>
                  <textarea class="form-control" id="kpi-risks"></textarea>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label" i18n:translate="">Responsible people</label>
                  <input type="hidden" class="pat-select2" id="kpi-responsible"
                              data-pat-select2="placeholder:Search users;
                                                vocabularyUrl:select2-users.json;"/>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <a type="button" class="btn button-cancel" data-dismiss="modal" i18n:translate="">Cancel</a>
              <a type="submit" class="btn button-save" id="createKPIFromModal"  data-dismiss="modal" i18n:translate="">Create</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <link rel="stylesheet" href="++theme++gwopa.theme/assets/javascripts/jquery-editable.css" rel="stylesheet"/>
    <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/jquery.poshytip.js"></script>
    <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/jquery-editable-poshytip.js"></script>
    <script type="text/javascript" src="++plone++static/components/bootstrap/js/modal.js"></script>
    <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/modal-output.js"></script>

  </metal:block>

</metal:content-core>

</body>
</html>
