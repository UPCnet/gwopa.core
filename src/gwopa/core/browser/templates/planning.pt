<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="gwopa">
<body>

<metal:content-core fill-slot="main"
    tal:define="portal_state context/@@plone_portal_state;
                portal_url portal_state/portal_url;">

  <metal:javascript fill-slot="javascript_head_slot">
    <script>
      require = undefined;
      define = undefined;
    </script>
    <script src="//unpkg.com/vue@2.5.21/dist/vue.js"></script>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </metal:javascript>

  <metal:block define-macro="content-core" tal:define="currentYear view/getYear">

    <h1 class="documentFirstHeading">Planning - Annual <tal:omit-tag tal:content="currentYear"></tal:omit-tag></h1>
    <div class="documentDescription description"> Annual Work Plan for year <tal:omit-tag tal:content="currentYear"></tal:omit-tag>

    <div class="wp-buttons">
      <a tal:attributes="href string:${context/absolute_url}/duplicateYear?id=${currentYear}">
        <button class="plone-btn-warning"><i class="fa fa-copy"></i> Duplicate Work Plan</button></a>
      <a tal:attributes="href string:${context/absolute_url}/deleteYear?id=${currentYear};">
        <button class="plone-btn-danger"><i class="fa fa-remove"></i> Delete Work Plan</button></a>
    </div>

    <div class="pat-autotoc autotabs" data-pat-autotoc="levels: legend; section: fieldset;">
      <fieldset style="min-width:100%">
        <legend>Project</legend>
        <div>
          <tal:block-activities tal:define="areas view/getAreas" tal:condition="areas">
            <tal:objects repeat="item areas">
              <ul class="item" style="list-style-type: none;">
                <li>
                  <h3>
                    <i class="fa fa-plus-circle"></i><a tal:attributes="href item/url" tal:content="item/title"> Item Title </a>
                    <a class="pat-plone-modal" data-pat-plone-modal="{&quot;actionOptions&quot;: {&quot;displayInModal&quot;: false}}" tal:attributes="href string:${item/url}/++add++Activity?year=${currentYear}" href="#"><button class="plone-btn plone-btn-sm plone-btn-success"> + New Activity </button></a>
                    <a class="pat-plone-modal" data-pat-plone-modal="{&quot;actionOptions&quot;: {&quot;displayInModal&quot;: false}}" tal:attributes="href string:${item/url}/++add++Output?year=${currentYear}" href="#"><button class="plone-btn plone-btn-sm plone-btn-success"> + New Output </button></a>
                    <span style="padding-left:20px;" tal:content="item/description"></span>
                  </h3>
                  <tal:block-subitems tal:define="files python:view.indicatorsInside(item);">
                    <ul tal:repeat="item files" class="block_sub_indicators">
                      <li class="indicator_item">
                        <span class="label label-default" tal:attributes="class string:label ${item/portal_type}"
                              tal:content="item/portal_type"> ACTIVITY </span>
                        <a tal:attributes="href item/url;title item/description" data-toggle="tooltip" class="pat-tooltip" tal:content="item/title"> Item Title </a>
                        <tal:omit.tag tal:condition="python:item['portal_type'] == 'Activity'">
                          <a class="pat-plone-modal" data-pat-plone-modal="{&quot;actionOptions&quot;: {&quot;displayInModal&quot;: false}}" tal:attributes="href string:${item/url}/++add++Output?year=${currentYear}" href="#"><button class="plone-btn plone-btn-sm plone-btn-success"> + New Output </button></a>
                          <tal:block-subitems2 tal:define="outputs python:view.indicatorsInside(item);">
                            <ol tal:repeat="output outputs" class="block_sub_indicators">
                              <span tal:attributes="class string:label ${output/portal_type}" tal:content="output/portal_type"> ACTIVITY </span>
                              <span tal:content="output/title"> TItle </span>
                              <a tal:attributes="href string:${item/url}/++add++TargetValue" href="#"><button class="plone-btn plone-btn-sm"> + Target Value </button></a>
                            </ol>
                          </tal:block-subitems2>
                        </tal:omit.tag>
                        <a tal:condition="python:item['portal_type'] == 'Output'" tal:attributes="href string:${item/url}/++add++TargetValue" href="#"><button class="plone-btn plone-btn-sm"> + Target Value </button></a>
                      </li>
                    </ul>
                  </tal:block-subitems>
                </li>
              </ul>
            </tal:objects>
          </tal:block-activities>
        </div>
      </fieldset>
      <fieldset style="min-width: 100%">
        <legend>Outcomes</legend>
        <div>
          <a class="pat-plone-modal" data-pat-plone-modal="{&quot;actionOptions&quot;: {&quot;displayInModal&quot;: false}}" tal:attributes="href string:${context/absolute_url}/++add++OutcomeKPI" href="#"><button class="context focus"> + New OutcomeKPI</button></a>
          <a class="pat-plone-modal" data-pat-plone-modal="{&quot;actionOptions&quot;: {&quot;displayInModal&quot;: false}}" tal:attributes="href string:${context/absolute_url}/++add++OutcomeZONE" href="#"><button class="context focus"> + New OutcomeZONE</button></a>
          <tal:block-ouctomeskpi tal:define="outcomes view/listOutcomesKPI" tal:condition="outcomes">
            <h3><i class="fa fa-plus-circle"></i> Utility Performance </h3>
            <tal:objects repeat="outcome outcomes">
              <ul class="item">
                <li style="padding-left: 20px; list-style: none;">
                  <span tal:attributes="class string:label ${outcome/portal_type}"
                              tal:content="outcome/portal_type"> ACTIVITY </span>
                  <a tal:attributes="href outcome/url; title outcome/description" data-toggle="tooltip" class="pat-tooltip">
                    <tal:block tal:content="outcome/title"> Outcome Title </tal:block></a>
                </li>
              </ul>
            </tal:objects>
          </tal:block-ouctomeskpi>
          <tal:block-ouctomes tal:define="outcomes view/listOutcomesCC" tal:condition="outcomes">
            <h3><i class="fa fa-plus-circle"></i> Utility Capacity </h3>
            <tal:objects repeat="outcome outcomes">
              <ul class="item">
                <li style="padding-left: 20px; list-style: none;">
                  <span tal:attributes="class string:label ${outcome/portal_type}"
                              tal:content="outcome/portal_type"> ACTIVITY </span>
                  <a class="pat-plone-modal" tal:attributes="href string:${outcome/url}"><tal:block tal:content="outcome/area"> Outcome Title </tal:block></a>
                </li>
              </ul>
            </tal:objects>
          </tal:block-ouctomes>
        </div>
      </fieldset>
    </div>

    <div id="app">
      <demo></demo>
    </div>

  </metal:block>

  <script src="/++theme++gwopa.theme/assets/javascripts/gwopa.umd.min.js"></script>

</metal:content-core>

</body>
</html>
