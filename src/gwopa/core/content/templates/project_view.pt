<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="gwopa">
<body>

<metal:content-core fill-slot="content-core">

    <div class="pull-right" tal:condition="context/image">
      <img tal:attributes="src string:${context/absolute_url}/@@images/image" />
    </div>

    <metal:block define-macro="content-core"
        tal:define="partners context/partners;
                    project_manager context/project_manager;
                    budget context/budget;
                    contribution context/contribution;
                    wop_program context/wop_program">

      <button type="button">
        <i class="fa fa-info-circle" aria-hidden="true"></i>
        <a tal:attributes="href string:${context/absolute_url}/indicators" href="#"> Show indicators </a>
      </button>
      <div tal:condition="partners">
        <h3 i18n:translate="">Partners</h3>
        <ul tal:repeat="partner partners">
          <li tal:content="partner"></li>
        </ul>
      </div>

      <div tal:condition="project_manager">
        <h3 i18n:translate="">Project Manager</h3>
        <span tal:content="project_manager" />
      </div>

      <div tal:condition="budget">
        <h3 i18n:translate="">Budget</h3>
        <span tal:content="budget" /> <span tal:content="context/currency" />
      </div>

      <div tal:condition="contribution">
        <h3 i18n:translate="">Contribution by partners and donors</h3>
        <span tal:replace="structure contribution/output" />
      </div>

      <div tal:condition="wop_program">
        <h3 i18n:translate="">WOP Program</h3>
        <ul tal:repeat="wop wop_program">
          <li tal:content="wop"></li>
        </ul>
      </div>
      <tal:block define="latitude context/latitude;
                   longitude context/longitude">
        <div style="width:50%" tal:condition="python: latitude and longitude" class="pat-leaflet map"
         data-geojson='{
          "type": "FeatureCollection",
          "features": [
            {
              "type": "Feature",
              "id": 1,
              "properties":
              {
                "popup": "<h4><a href=>${context/Title}</a></h4><p>Start: ${context/start}</p><p>End: ${context/end}</p>"
              },
              "geometry":
              {
                "type": "Point",
                "coordinates": [ ${longitude},
                  ${latitude}
                ]
              }
            }
          ]}' data-pat-leaflet='{
           "fullscreencontrol": true,
           "locatecontrol": false,
           "zoomcontrol": true,
           "minimap": false,
           "addmarker": false,
           "zoom": 17,
           "map_layers": [
            {"title": "Map", "id": "OpenStreetMap.BlackAndWhite"}
           ]
          }'>
        </div>
        <span tal:condition="latitude"> Latitude: <tal:omit-tag tal:content="latitude"></tal:omit-tag></span><br/>
        <span tal:condition="longitude"> Longitude: <tal:omit-tag tal:content="longitude"></tal:omit-tag></span>
        <div class="clearfix"></div>
        <h1 class="documentFirstHeading paddingtop"> Areas</h1>
        <tal:repeatProjects repeat="item view/getImprovementAreas">
          <div class="col-lg-3 col-md-6">
            <a tal:attributes="href item/url;
                               title item/title;
                               alt item/title">
            <div class="box">
              <img class="img200"
                   tal:attributes="src string:${item/image};"/>
              <div class="card-body">
                <h4 class="card-title">
                  <a tal:attributes="href item/url" tal:content="item/title">Event Title</a>
                </h4>
              </div>
            </div>
          </a>
          </div>
      </tal:repeatProjects>
        <!-- <tal:debug><?python import ipdb; ipdb.set_trace()?></tal:debug> -->
    </tal:block>
  </metal:block>

</metal:content-core>

</body>
</html>


<!-- {"title": "Map", "id": "OpenStreetMap.BlackAndWhite"},
     {"title": "Satellite", "id": "Esri.WorldImagery"},
     {"title": "Topographic", "id": "OpenTopoMap"},
     {"title": "Toner", "id": "Stamen.Toner"} -->
