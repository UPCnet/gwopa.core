<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="gwopa">
<body>

<metal:content-core fill-slot="main"
      tal:define="wop_program context/wop_program;
                  wop_platform context/wop_platform;
                  objectives context/objectives;
                  team context/members;
                  getImprovementAreas view/getImprovementAreas;
                  categories context/category|nothing;
                  country context/country;
                  location context/location;
                  url_quote nocall:modules/Products.PythonScripts.standard/url_quote;
                  canEdit not:view/canEdit;
                  partners view/getPartners;
                  donors view/donors;
                  others view/others;
                  get_budget view/get_budget;
                  getProject_manager view/getProject_manager;">

  <h1 class="documentFirstHeading">
    <a tal:condition="canEdit" tal:attributes="href string:${context/absolute_url}/edit;" title="Edit project" alt="Edit project" href="#"><tal:omit-tag tal:content="context/title"> Project Title</tal:omit-tag>&nbsp;<i class="far fa-edit"></i></a>
    <tal:omit-tag tal:condition="not:canEdit" tal:content="context/title"> Project Title</tal:omit-tag>
  </h1>

  <div class="row">
    <div tal:attributes="class python:getImprovementAreas and 'col-md-9' or 'col-md-12';">
      <div class="row">
        <div class="col-md-3">
          <img class="fullwidth" tal:condition="context/image" tal:attributes="src string:${context/absolute_url}/@@images/image" />
          <i class="fas fa-map-marker-alt"></i>&nbsp;<tal:block tal:condition="location"> <span tal:content="location"></span>, </tal:block><span tal:content="country"></span>
        </div>
        <div class="col-md-9">
          <tal:objectives tal:condition="objectives">
            <h2 i18n:translate=""> Description and main objectives </h2>
            <span class="more" tal:content="structure objectives/output"> Project Objectives </span>
          </tal:objectives>
          <span tal:condition="categories" tal:repeat="category categories" class="tags">
            <a href="" class="link-category" rel="tag"
               tal:content="category"
               tal:define="quotedCat python:url_quote(category)"
               tal:attributes="href string:${context/@@plone_portal_state/navigation_root_url}/@@search?Subject%3Alist=${quotedCat}">
              Category
            </a>
          </span>
        </div>
      </div>

      <div class="row" tal:condition="python: wop_platform or wop_program">
        <hr/>
        <div class="col-md-6">
          <h2 i18n:translate=""> Project Dates </h2>
          <div class="col-md-6">
            <div tal:condition="context/startactual" class="actualDate" >
              <span i18n:translate="">Start:</span>
              <tal:omit-tag tal:content="context/startactual">2019-02-02</tal:omit-tag>
            </div>
            <div class="plannedDate" tal:condition="view/planneddates">
              <span i18n:translate="">Start (Planned):</span>
              <tal:omit-tag tal:content="context/startplanned">2019-02-02</tal:omit-tag>
            </div>
          </div>
          <div class="col-md-6">
            <div class="actualDate" tal:condition="context/completionactual">
              <span i18n:translate="">End:</span>
              <tal:omit-tag tal:content="context/completionactual">2019-02-02</tal:omit-tag>
            </div>
            <div class="plannedDate" tal:condition="view/planneddates">
              <span i18n:translate="">End (Planned):</span>
              <tal:omit-tag tal:content="context/completionplanned">2019-02-02</tal:omit-tag>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <h2 i18n:translate=""> Association to platforms or programmes</h2>
          <ul>
            <li tal:content="wop_platform" tal:condition="wop_platform"></li>
            <li tal:content="wop_program" tal:condition="wop_program"></li>
          </ul>
        </div>
      </div>

      <div class="row" tal:condition="python: not (wop_platform or wop_program)">
        <hr/>
        <div>
          <h2 i18n:translate=""> Project Dates </h2>
          <div class="col-md-6">
            <div tal:condition="context/startactual" class="actualDate" >
              <span i18n:translate="">Start:</span>
              <tal:omit-tag tal:content="context/startactual">2019-02-02</tal:omit-tag>
            </div>
            <div class="plannedDate" tal:condition="view/planneddates">
              <span i18n:translate="">Start (Planned):</span>
              <tal:omit-tag tal:content="context/startplanned">2019-02-02</tal:omit-tag>
            </div>
          </div>
          <div class="col-md-6">
            <div class="actualDate" tal:condition="context/completionactual">
              <span i18n:translate="">End:</span>
              <tal:omit-tag tal:content="context/completionactual">2019-02-02</tal:omit-tag>
            </div>
            <div class="plannedDate" tal:condition="view/planneddates">
              <span i18n:translate="">End (Planned):</span>
              <tal:omit-tag tal:content="context/completionplanned">2019-02-02</tal:omit-tag>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <hr/>
        <h2 i18n:translate=""> Main organizations and their contributions </h2>

        <div class="table-responsive col-md-12">
          <table class="table table-condensed table-hover">
            <thead>
              <tr>
                <th style="padding-left:0px;">
                  <a data-toggle="modal" class="addPartner" data-target="#modalPartner" tal:attributes="data-url string:${view/getPath}/contribs;" data-type="ContribPartner">
                    <i class="fas fa-plus-circle"></i></a>&nbsp;<span style="font-size: 18px;"> Partner Water Operators </span>
                </th>
                <th class="contibutioncentered" i18n:translate="">In-cash</th>
                <th class="contibutioncentered" i18n:translate="">In-kind</th>
              </tr>
            </thead>
            <tr tal:repeat="partner partners">
              <td><a class="pat-plone-modal" tal:attributes="href string:${partner/edit}" href="#"><i class="far fa-edit"></i></a>&nbsp;<tal:block tal:content="partner/title"></tal:block></td>
              <td class="contibutioncentered" tal:content="partner/incash"></td>
              <td class="contibutioncentered" tal:content="partner/inkind"></td>
            </tr>
          </table>
        </div>

        <div class="table-responsive col-md-12">
          <table class="table table-condensed table-hover">
            <thead>
              <tr>
                <th style="padding-left:0px;">
                  <a data-toggle="modal" class="addPartner" data-target="#modalPartner" tal:attributes="data-url string:${view/getPath}/contribs;" data-type="ContribDonor">
                    <i class="fas fa-plus-circle"></i></a>&nbsp;<span style="font-size: 18px;"> Donors </span>
                </th>
                <th class="contibutioncentered" i18n:translate="">In-cash</th>
                <th class="contibutioncentered" i18n:translate="">In-kind</th>
              </tr>
            </thead>
            <tr tal:repeat="partner donors">
              <td><a class="pat-plone-modal" tal:attributes="href string:${partner/edit}" href="#"><i class="far fa-edit"></i></a>&nbsp;<tal:block tal:content="partner/title"></tal:block></td>
              <td class="contibutioncentered" tal:content="partner/incash"></td>
              <td class="contibutioncentered" tal:content="partner/inkind"></td>
            </tr>
          </table>
        </div>

        <div class="table-responsive col-md-12">
          <table class="table table-condensed table-hover">
            <thead>
              <tr>
                <th style="padding-left:0px;">
                  <a data-toggle="modal" class="addPartner" data-target="#modalPartner" tal:attributes="data-url string:${view/getPath}/contribs;" data-type="ContribOther">
                    <i class="fas fa-plus-circle"></i></a>&nbsp;<span style="font-size: 18px;"> Other Organizations </span>
                </th>
                <th class="contibutioncentered" i18n:translate="">In-cash</th>
                <th class="contibutioncentered" i18n:translate="">In-kind</th>
              </tr>
            </thead>
            <tr tal:repeat="partner others">
              <tal:block tal:condition="partner">
                <td><a class="pat-plone-modal" tal:attributes="href string:${partner/edit}" href="#"><i class="far fa-edit"></i></a>&nbsp;<tal:block tal:content="partner/title"></tal:block></td>
                <td class="contibutioncentered" tal:content="partner/incash"></td>
                <td class="contibutioncentered" tal:content="partner/inkind"></td>
              </tal:block>
            </tr>
          </table>
        </div>

        <div class="buttonbudget" tal:condition="get_budget">
          <tal:omit-tag i18n:translate="">Total budget: </tal:omit-tag>&nbsp;<span tal:content="get_budget"></span>
        </div>
      </div>

      <div class="row" tal:condition="getProject_manager">
        <hr/>
        <div class="col-md-12">
          <h2 i18n:translate=""> Focal point partner </h2>
          <div class="table-responsive">
            <table id="tableFocalPoint" class="table table-condensed table-hover">
              <thead>
                <tr>
                  <th i18n:translate="">Name</th>
                  <th i18n:translate="">Partner</th>
                  <th i18n:translate="">Contact</th>
                </tr>
              </thead>
              <tal:block-partners tal:repeat="partner getProject_manager">
                <tr tal:attributes="class partner/managerClass">
                  <td>
                    <tal:block tal:replace="structure partner/image"></tal:block>
                    <tal:block tal:content="partner/name"></tal:block>
                  </td>
                  <tal:block tal:define="value partner/partners" tal:condition="partner/partners">
                    <td tal:condition="python:isinstance(value, basestring)">
                      <span tal:replace="field/value"></span>
                    </td>
                    <td tal:condition="not:python:isinstance(value, basestring)">
                      <span tal:replace="structure python:'<span>'+'</span><span>'.join(str(s)+str(', ') for s in value)" />
                    </td>
                    <td>
                      <tal:block tal:condition="partner/email"><a tal:attributes="href string:mailto:${partner/email}"><i class="far fa-envelope"></i></a></tal:block>
                      <tal:block tal:content="partner/email"></tal:block>
                    </td>
                  </tal:block>
                </tr>
              </tal:block-partners>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3" tal:condition="getImprovementAreas">
      <h2 class="h2Project" i18n:translate=""> Working Areas </h2>
      <tal:areas repeat="item getImprovementAreas">
        <div class="col-lg-12 col-md-12">
          <a tal:attributes="href item/url; title item/description; alt item/description">
            <div class="box">
              <img class="box-img" tal:attributes="src string:${item/image};"/>
              <div class="card-body">
                <span class="card-title" tal:content="item/title">Working area Title </span>
              </div>
            </div>
          </a>
        </div>
      </tal:areas>
      <div id="membersBlock" tal:define="recent_items view/getMembers">
        <h2 class="h2Project" i18n:translate="">Members</h2>
        <table class="table table-condensed table-striped">
          <tbody>
            <tal:items tal:repeat="obj recent_items">
              <tr>
                <td tal:content="obj/id"> User Photo </td>
                <td tal:content="obj/email"> Phone</td>
              </tr>
            </tal:items>
          </tbody>
        </table>
      </div>
      <div id="filesBlock" tal:define="recent_items view/getFiles">
        <h2 class="h2Project">
          <a tal:attributes="href string:${context/absolute_url}/files/" i18n:translate="">Recent files</a>
          <a class="pat-plone-modal right" id="add-new-file" data-pat-plone-modal="{&quot;actionOptions&quot;: {&quot;displayInModal&quot;: false}}" tal:attributes="href string:${context/absolute_url}/files/++add++File">
            <button id="add-new-file" class="context focus" i18n:translate=""> + New file </button>
          </a>
        </h2>
        <table class="table table-condensed">
          <tbody>
            <tal:items tal:repeat="obj recent_items">
              <tr>
                <td>
                  <a href="" tal:attributes="href obj/url"><tal:omit-tag tal:content="obj/title">
                    TITLE</tal:omit-tag>
                  </a>
                </td>
                <td>
                  <span tal:content="obj/date"></span>
                </td>
              </tr>
            </tal:items>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="modalPartner" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalAddPartner" data-dismiss="modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <form class="form-horizontal">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="modalAddPartner" i18n:translate=""> Add Contributor </h4>
          </div>
          <div class="modal-body" id="NewDonor">
            <div class="form-group" style="padding-top:15px;">
              <label class="col-sm-2 control-label" for="exampleInputAmount" i18n:translate="" > Name </label>
              <div class="input-group col-sm-10">
                <input type="text" class="form-control" id="partnerName">
                <input type="hidden" class="modal-url" id="partnerPath"/>
                <input type="hidden" class="modal-type" id="partnerType"/>
              </div>
            </div>
            <div class="form-group" style="padding-top:15px;">
              <label class="col-sm-2 control-label" for="exampleInputAmount" i18n:translate=""> In-cash </label>
              <div class="input-group col-sm-10">
                <div class="input-group-addon">$</div>
                <input type="text" class="form-control" id="incash">
              </div>
            </div>
            <div class="form-group" style="padding-top:15px;">
              <label class="col-sm-2 control-label" for="exampleInputAmount" i18n:translate=""> In-kind </label>
              <div class="input-group col-sm-10">
                <div class="input-group-addon">$</div>
                <input type="text" class="form-control" id="inkind">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <a type="button" class="btn button-cancel" data-dismiss="modal" i18n:translate="">Cancel</a>
            <a type="submit" class="btn button-save" id="createPartnerFromModal"  data-dismiss="modal" i18n:translate="">Save</a>
          </div>
        </form>
      </div>
    </div>
  </div>
  <link rel="stylesheet" href="++theme++gwopa.theme/assets/javascripts/jquery-editable.css" rel="stylesheet"/>
  <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/jquery.poshytip.js"></script>
  <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/jquery-editable-poshytip.js"></script>
  <script type="text/javascript" src="++plone++static/components/bootstrap/js/modal.js"></script>
  <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/project.js"></script>
  <script type="text/javascript" src="++theme++gwopa.theme/assets/javascripts/readmore.js"></script>

</metal:content-core>

</body>
</html>
